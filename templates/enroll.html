<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <title>學生報名課程</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

    <div class="container py-5">
        <h2 class="mb-4">學生報名課程</h2>

        <div class="card p-4 shadow rounded">
            <form id="enrollForm">
                <div class="mb-3">
                    <label for="studentId" class="form-label">學生 ID</label>
                    <input type="number" class="form-control" id="studentId" placeholder="請輸入學生 ID" required>
                </div>
                <div class="mb-3">
                    <label for="courseId" class="form-label">課程 ID</label>
                    <input type="number" class="form-control" id="courseId" placeholder="請輸入課程 ID" required>
                </div>
                <button type="submit" class="btn btn-primary">報名</button>
            </form>

            <div id="message" class="mt-3"></div>
        </div>
    </div>

    <script>
        document.getElementById("enrollForm").addEventListener("submit", async function (e) {
            e.preventDefault();

            const studentId = document.getElementById("studentId").value;
            const courseId = document.getElementById("courseId").value;
            const messageDiv = document.getElementById("message");

            try {
                const response = await fetch("http://127.0.0.1:8000/api/enroll/", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        student_id: studentId,
                        course_id: courseId
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    messageDiv.innerHTML = `<div class="alert alert-success">✅ ${data.message || '報名成功'}</div>`;
                } else {
                    messageDiv.innerHTML = `<div class="alert alert-danger">❌ ${data.error || '報名失敗'}</div>`;
                }
            } catch (err) {
                messageDiv.innerHTML = `<div class="alert alert-danger">⚠️ 發生錯誤：${err.message}</div>`;
            }
        });
    </script>

</body>

</html>